database:
  image: postgres:9.5
  environment:
    - POSTGRES_USER=lambdatrade

auth-service:
  build: .
  links:
    - database
  volumes:
    - ./testsetup.sh:/testsetup.sh
  environment:
    - log=true

#One or more application container
upstream:
  image: nginx:latest
  volumes:
    - ./index.html:/www/index.html
    - ./upstream-nginx.conf:/etc/nginx/nginx.conf

nginx:
  build: web
  # s/8000/<desired port>
  ports:
    - 8000:80
  links:
    - auth-service
    # Link upstream containers to their instance IDs
    - upstream:de305d54-75b4-431b-adb2-eb6b9e546014

frontend:
  image: nginx:latest
  volumes:
    - ./frontend/nginx.conf:/etc/nginx/nginx.conf
    - ./frontend/index.html:/www/index.html
    - ./frontend/authenticate.html:/www/authenticate.html
    - ./frontend/skip.html:/www/skip.html
  links:
    - auth-service
  ports:
    - 8008:80